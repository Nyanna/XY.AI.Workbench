<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
	<extension
		point="org.eclipse.ui.editors">
		<editor
			class="xy.ai.workbench.editors.AISessionEditor"
			contributorClass="xy.ai.workbench.editors.AISessionEditorContributor"
			extensions="md"
			icon="icons/sample.png"
			id="xy.ai.workbench.editors.AISessionEditor"
			name="XY.AI Editor"
			symbolicFontName="org.eclipse.jface.bannerfont">
		</editor>
	</extension>
	<extension
		point="org.eclipse.help.contexts">
		<contexts
			file="contexts.xml">
		</contexts>
	</extension>
	<extension
		point="org.eclipse.ui.views">
		<category
			id="XY.AI.Workbench"
			name="AI">
		</category>
		<view
			allowMultiple="false"
			category="XY.AI.Workbench"
			class="xy.ai.workbench.views.AISessionView"
			icon="icons/sample.png"
			id="xy.ai.workbench.views.AISessionView"
			inject="true"
			name="XY.Ai Session Settings">
		</view>
		<view
			allowMultiple="false"
			category="XY.AI.Workbench"
			class="xy.ai.workbench.views.AIBatchView"
			icon="icons/sample.png"
			id="xy.ai.workbench.views.AIBatchView"
			inject="true"
			name="XY.AI Batch List">
		</view>
		<view
			name="AI Explorer"
			icon="icons/sample.png"
			category="XY.AI.Workbench"
			class="xy.ai.workbench.views.explorer.MarkdownExplorerView"
			id="xy.ai.workbench.views.AIExplorer">
		</view>
	</extension>
	<extension point="org.eclipse.ui.navigator.navigatorContent">
		<navigatorContent
			name="AI Content"
            contentProvider="xy.ai.workbench.views.explorer.MarkdownContentProvider"
			labelProvider="xy.ai.workbench.views.explorer.MarkdownLabelProvider"
			id="xy.ai.workbench.views.content.AIContent"
			priority="normal">
			<triggerPoints>
				<instanceof value="org.eclipse.core.resources.IResource" />
			</triggerPoints>
			<possibleChildren>
				<instanceof value="org.eclipse.core.resources.IResource" />
			</possibleChildren>
	       <commonWizard
	            type="new"
	            wizardId="XY.AI.Workbench.wizard.newfile.chat"
	            menuGroupId="new.ext">
            <enablement>
                  <instanceof value="org.eclipse.core.resources.IFolder"/>
            </enablement>
	       </commonWizard>
	       <commonWizard
	            type="new"
	            wizardId="XY.AI.Workbench.wizard.newfile.markdown"
	            menuGroupId="new.ext">
            <enablement>
                  <instanceof value="org.eclipse.core.resources.IFolder"/>
            </enablement>
	       </commonWizard>
	       <commonWizard
	            type="new"
	            wizardId="XY.AI.Workbench.wizard.newfile.context"
	            menuGroupId="new.ext">
            <enablement>
                  <instanceof value="org.eclipse.core.resources.IFolder"/>
            </enablement>
	       </commonWizard>
		</navigatorContent>
	</extension>
	<extension point="org.eclipse.ui.navigator.viewer">
		<viewer
        inheritBindingsFromViewer="org.eclipse.ui.navigator.ProjectExplorer"
        popupMenuId="org.eclipse.ui.navigator.ProjectExplorer#PopupMenu"
        viewerId="xy.ai.workbench.views.AIExplorer">
  		</viewer>
	   <viewerContentBinding viewerId="xy.ai.workbench.views.AIExplorer">
	      <includes>
	         <contentExtension pattern="xy.ai.workbench.views.content.AIContent"/>
	      </includes>
	      <excludes>
		      <contentExtension 
		          pattern="^(?!xy\.ai\.workbench\.views\.content\.AIContent$).*">
		      </contentExtension>
	      </excludes>
	   </viewerContentBinding>
	</extension>
	<extension
		point="org.eclipse.ui.commands">
		<category
			id="XY.AI.Workbench.commands.category"
			name="AI">
		</category>
		<command
			categoryId="XY.AI.Workbench.commands.category"
			id="XY.AI.Workbench.commands.submitPromptCommand"
			name="Submit prompt">
		</command>
		<command
			categoryId="XY.AI.Workbench.commands.category"
			id="XY.AI.Workbench.commands.editor.comment"
			name="Toggle AI Comment">
		</command>
	</extension>
	<extension
		point="org.eclipse.ui.handlers">
		<handler
			class="xy.ai.workbench.handlers.SessionExecuteHandler"
			commandId="XY.AI.Workbench.commands.submitPromptCommand">
		</handler>
		<handler
			class="xy.ai.workbench.editors.CommentHandler"
			commandId="XY.AI.Workbench.commands.editor.comment">
			<activeWhen>
				<and>
					<with variable="activeEditorId">
						<equals
							value="xy.ai.workbench.editors.AISessionEditor">
						</equals>
					</with>
					<with variable="activeEditor">
						<instanceof
							value="xy.ai.workbench.editors.AISessionEditor" />
					</with>
				</and>
			</activeWhen>
		</handler>
	</extension>
	<extension
		point="org.eclipse.ui.bindings">
		<key
			commandId="XY.AI.Workbench.commands.submitPromptCommand"
			contextId="org.eclipse.ui.contexts.window"
			schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
			sequence="M1+Enter">
		</key>
		<key
			commandId="XY.AI.Workbench.commands.editor.comment"
			contextId="org.eclipse.ui.textEditorScope"
			schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
			sequence="Shift+Ctrl+C">
		</key>
	</extension>
	<extension
		point="org.eclipse.ui.menus">
		<menuContribution
			locationURI="menu:org.eclipse.ui.main.menu?after=additions">
			<menu
				id="XY.AI.Workbench.menus.aiMenu"
				label="AI"
				mnemonic="A">
				<command
					commandId="XY.AI.Workbench.commands.submitPromptCommand"
					icon="icons/sample.png"
					id="XY.AI.Workbench.menus.submitPromptCommand"
					mnemonic="S">
				</command>
			</menu>
		</menuContribution>
		<menuContribution
			locationURI="toolbar:org.eclipse.ui.main.toolbar?after=additions">
			<toolbar
				id="XY.AI.Workbench.toolbars.aiToolbar">
				<command
					commandId="XY.AI.Workbench.commands.submitPromptCommand"
					icon="icons/sample.png"
					id="XY.AI.Workbench.toolbars.submitPromptCommand"
					tooltip="Submit the current prompt">
				</command>
			</toolbar>
		</menuContribution>
	</extension>
	<extension
		point="org.eclipse.ui.perspectiveExtensions">
		<perspectiveExtension
			targetID="org.eclipse.jdt.ui.JavaPerspective">
			<view
				id="xy.ai.workbench.views.AIBatchView"
				ratio="0.5"
				relationship="bottom"
				relative="org.eclipse.ui.views.ProblemView">
			</view>
		</perspectiveExtension>
	</extension>
	<extension
		point="org.eclipse.ui.fontDefinitions">
		<fontDefinition
			id="XY.AI.Workbench.fontDefinition1"
			label="XY.AI Editor Font"
			value="1|Arial|10.0|0|WINDOWS|1|0|0|0|0|0|0|0|0|3|0|0|0|Arial;">
		</fontDefinition>
	</extension>
	<extension
		id="xy.ai.workbench.promptmarker"
		name="XY.AI Prompt Marker"
		point="org.eclipse.core.resources.markers">
		<persistent
			value="true">
		</persistent>
		<super
			type="org.eclipse.core.resources.taskmarker">
		</super>
	</extension>
	<extension
		point="org.eclipse.ui.newWizards">
		<wizard
			id="XY.AI.Workbench.wizard.newfile.markdown"
			name="Markdown File"
			class="xy.ai.workbench.handlers.NewMarkdownWizard"
			category="XY.AI.Workbench.newfile.category"
			icon="icons/sample.png">
			<description>
				Creates a new Markdown file.
			</description>
		</wizard>
		<wizard
			id="XY.AI.Workbench.wizard.newfile.context"
			name="Prompt Context"
			class="xy.ai.workbench.handlers.NewPromptContextWizard"
			category="XY.AI.Workbench.newfile.category"
			icon="icons/sample.png">
			<description>
				Creates a new Prompt Context file.
			</description>
		</wizard>
		<wizard
			id="XY.AI.Workbench.wizard.newfile.chat"
			name="AI Chat"
			class="xy.ai.workbench.handlers.NewChatWizard"
			category="XY.AI.Workbench.newfile.category"
			icon="icons/sample.png">
			<description>
				Creates a new AI Chat file.
			</description>
		</wizard>
		<category
			id="XY.AI.Workbench.newfile.category"
			name="AI Files">
		</category>
	</extension>

</plugin>
